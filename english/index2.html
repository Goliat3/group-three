<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Study - English Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f9f9f9;
        }

        [contenteditable] {
            border: 1px dashed #ccc;
            padding: 0.75rem;
            min-height: 60px;
            outline: none;
            cursor: text;
            border-radius: 5px;
        }

        [contenteditable]:focus {
            border-color: #007BFF;
            background-color: #f0f8ff;
        }

        button {
            background-color: #007BFF;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0 5px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-blue-500 text-white p-6 text-center rounded-b-md">
        <h1 class="text-4xl font-bold">Quiz Study</h1>
        <p class="text-lg mt-2">Practice and improve your English comprehension.</p>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto mt-10 grid grid-cols-3 gap-6">
        <!-- Left Column: Problem and Choices -->
        <div class="col-span-2 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4">지문</h2>
            <div id="problem" class="p-4 bg-gray-100 rounded mb-6">The problem will appear here.</div>

            <h3 class="text-xl font-semibold mb-2">선지</h3>
            <div id="options" class="mb-6">
                <!-- Radio options will be dynamically inserted here -->
            </div>

            <div class="flex space-x-4">
                <button onclick="newProblem()">새로운 문제</button>
                <button onclick="showAnswer()">완성</button>
                <button onclick="clearContent()">초기화</button>
                <button onclick="saveContent()">저장</button>
                <button onclick="toggleSavedList()">저장 목록 보기</button>
            </div>

            <!-- Saved List Section -->
            <div id="saved-list-section" class="hidden mt-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold">저장된 목록</h3>
                    <button onclick="toggleSavedList()" class="text-red-500 text-sm font-bold">닫기</button>
                </div>
                <ul id="saved-list" class="list-disc ml-6">
                    <!-- 저장된 목록이 여기에 추가됩니다 -->
                </ul>
            </div>
        </div>

        <!-- Right Column: Notes and Grammar Check -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold mb-4">필기</h3>

            <h4 class="text-lg font-semibold mb-2">글의 주제</h4>
            <div id="main-topic" contenteditable="true" class="p-4 bg-gray-100 rounded mb-4">여기에 글의 주제를 입력하세요.</div>

            <h4 class="text-lg font-semibold mb-2">핵심 어휘</h4>
            <div id="vocabulary" contenteditable="true" class="p-4 bg-gray-100 rounded mb-4">여기에 핵심 어휘를 정리하세요.</div>

            <h4 class="text-lg font-semibold mb-2">문법 체크</h4>
            <div id="grammar-check" contenteditable="true" class="p-4 bg-gray-100 rounded">여기에 문법을 체크하세요.</div>
        </div>
    </div>

    <!-- Result Section -->
    <div id="result-section" class="max-w-7xl mx-auto mt-6 hidden text-center">
        <h2 id="result" class="text-2xl font-bold"></h2>
        <p id="translation" class="text-lg text-gray-800 mt-4"></p>
    </div>

    <script>
        const problemDataArray = [
            { sentence: "The Internet has revolutionized communication, allowing people to connect instantly across the globe.", translation: "인터넷은 전 세계 사람들을 즉시 연결하며 의사소통을 혁신했습니다.", topic: "인터넷과 의사소통" },
            { sentence: "Climate change poses significant risks to global ecosystems and human societies.", translation: "기후 변화는 세계 생태계와 인간 사회에 중대한 위험을 제기합니다.", topic: "기후 변화와 그 영향" },
            { sentence: "Education is the most powerful weapon which you can use to change the world.", translation: "교육은 세상을 변화시키는 데 사용할 수 있는 가장 강력한 무기입니다.", topic: "교육의 중요성" },
            { sentence: "Exercise not only improves physical health but also enhances mental well-being.", translation: "운동은 신체 건강을 향상시킬 뿐만 아니라 정신 건강도 증진시킵니다.", topic: "운동과 건강" },
            { sentence: "Artificial intelligence is transforming industries and reshaping the future of work.", translation: "인공지능은 산업을 변화시키고 일의 미래를 재구성하고 있습니다.", topic: "인공지능과 산업의 변화" }
        ];

        let currentProblemIndex = 0;
        let currentOptions = [];

        function newProblem() {
            const randomIndex = Math.floor(Math.random() * problemDataArray.length);
            currentProblemIndex = randomIndex;

            const problem = problemDataArray[currentProblemIndex];
            document.getElementById('problem').innerText = problem.sentence;

            const topics = problemDataArray.map(p => p.topic);
            const correctTopic = problem.topic;
            currentOptions = shuffleArray([...topics.filter(t => t !== correctTopic).slice(0, 4), correctTopic]);

            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = currentOptions
                .map((option, index) => `<label><input type="radio" name="options" value="${index}" class="mr-2">${option}</label><br>`)
                .join("");

            document.getElementById('result-section').classList.add('hidden');
        }

        function showAnswer() {
            const selectedOption = document.querySelector('input[name="options"]:checked');
            if (!selectedOption) {
                alert("정답을 선택해주세요!");
                return;
            }

            const selectedIndex = parseInt(selectedOption.value);
            const correctIndex = currentOptions.indexOf(problemDataArray[currentProblemIndex].topic);

            const resultElement = document.getElementById('result');
            const translationElement = document.getElementById('translation');
            const resultSection = document.getElementById('result-section');

            resultElement.innerText = selectedIndex === correctIndex ? "정답입니다!" : `오답입니다. 정답은 ${correctIndex + 1}번입니다.`;
            translationElement.innerText = problemDataArray[currentProblemIndex].translation;
            resultSection.classList.remove('hidden');
        }

        function saveContent() {
            const saveName = prompt("저장 이름을 입력하세요:");
            if (!saveName) {
                alert("저장 이름이 필요합니다.");
                return;
            }

            const mainTopic = document.getElementById('main-topic').innerText;
            const vocabulary = document.getElementById('vocabulary').innerText;
            const grammarCheck = document.getElementById('grammar-check').innerText;

            const data = { mainTopic, vocabulary, grammarCheck };
            localStorage.setItem(saveName, JSON.stringify(data));

            alert(`"${saveName}"으로 저장되었습니다.`);
            updateSavedList();
        }
        
        function displaySavedList() {
            const savedListSection = document.getElementById('saved-list-section');
            savedListSection.classList.toggle('hidden');
            updateSavedList();
        }

        function toggleSavedList() {
            const savedListSection = document.getElementById('saved-list-section');
            savedListSection.classList.toggle('hidden');
            updateSavedList();
        }


        function updateSavedList() {
            const savedList = document.getElementById('saved-list');
            savedList.innerHTML = "";

            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const listItem = document.createElement('li');
                listItem.innerHTML = 
                `<span>${key}</span> 
                <button onclick="loadSavedContent('${key}')">불러오기</button>
                <button onclick="deleteSavedContent('${key}')">삭제</button>`;
                savedList.appendChild(listItem);
            }
        }

        function loadSavedContent(saveName) {
            const savedData = localStorage.getItem(saveName);
            if (savedData) {
                const { mainTopic, vocabulary, grammarCheck } = JSON.parse(savedData);
                document.getElementById('main-topic').innerText = mainTopic;
                document.getElementById('vocabulary').innerText = vocabulary;
                document.getElementById('grammar-check').innerText = grammarCheck;
                alert(`"${saveName}"의 내용을 불러왔습니다.`);
            } else {
                alert(`"${saveName}"에 저장된 내용이 없습니다.`);
            }
        }

        function deleteSavedContent(saveName) {
            if (confirm(`"${saveName}"을(를) 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`)) {
                localStorage.removeItem(saveName);
                updateSavedList();
                alert(`"${saveName}"이(가) 삭제되었습니다.`);
            }
        }


        function clearContent() {
            if (confirm("현재 화면의 내용을 초기화하시겠습니까? 저장된 데이터는 삭제되지 않습니다.")) {
                document.getElementById('main-topic').innerText = "여기에 글의 주제를 입력하세요.";
                document.getElementById('vocabulary').innerText = "여기에 핵심 어휘를 정리하세요.";
                document.getElementById('grammar-check').innerText = "여기에 문법을 체크하세요.";
                alert("화면 내용이 초기화되었습니다.");
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        window.onload = newProblem;
    </script>
</body>
</html>
